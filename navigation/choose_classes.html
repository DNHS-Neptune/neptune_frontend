---
layout: post
title:
permalink: /choose_classes/
menu: nav/home.html
search_exclude: true
show_reading_time: false
---

<style>
  .container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 50px;
    margin-top: 30px;
  }

  .sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .content {
    flex-grow: 1;
    background: #222;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    min-width: 400px;
  }

  .dropdown {
    padding: 20px;
    font-size: 1.5rem;
    cursor: pointer;
    background: linear-gradient(135deg, #4e4e4e, #1a1a1a);
    color: white;
    border: none;
    border-radius: 30px;
    width: 200px;
    text-align: center;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s ease, background 0.3s ease;
  }

  .dropdown:hover {
    background: linear-gradient(135deg, #6a6a6a, #2d2d2d);
    transform: scale(1.1);
  }

  .dropdown-menu {
    display: none;
    background: #333;
    border: 1px solid #555;
    border-radius: 10px;
    padding: 10px;
    width: 100%;
    max-height: 300px;
    overflow-y: auto;
  }

  .dropdown-menu.show {
    display: block;
  }

  .class-card {
    background: #444;
    color: white;
    padding: 10px;
    border-radius: 5px;
    margin: 5px 0;
    cursor: pointer;
    transition: background 0.3s;
    text-align: center;
  }

  .class-card:hover {
    background: #666;
  }
</style>

<!-- Header with Logo and Title -->
<div class="header-container" style="text-align: center;">
  <h1>Choose Your Classes</h1>
</div>

<!-- Layout container -->
<div class="container">
  <div class="sidebar">
    <button class="dropdown" data-period="1">Period 1</button>
    <button class="dropdown" data-period="2">Period 2</button>
    <button class="dropdown" data-period="3">Period 3</button>
    <button class="dropdown" data-period="4">Period 4</button>
    <button class="dropdown" data-period="5">Period 5</button>
  </div>
  <div class="content" id="class-list">
    <p style="color: white; text-align: center;">Select a period to see available classes.</p>
  </div>
</div>

<script>
  var pythonURI;
  if (location.hostname === "localhost") {
    pythonURI = "http://localhost:8204";
  } else {
    pythonURI = "https://neptune.stu.nighthawkcodingsociety.com";
  }

  const fetchOptions = {
    method: "GET",
    mode: "cors",
    cache: "default",
    credentials: "include",
    headers: {
      "Content-Type": "application/json",
      "X-Origin": "client",
    },
  };

  function getClasses() {
    fetch(`${pythonURI}/api/class/add`, fetchOptions)
      .then((res) => res.json())
      .then((classes) => {
        let periodButtons = document.querySelectorAll(".dropdown");
        let classListContainer = document.getElementById("class-list");

        periodButtons.forEach((button) => {
          button.addEventListener("click", function () {
            let period = button.dataset.period;
            classListContainer.innerHTML = `<h2 style='color:white; text-align:center;'>Classes for Period ${period}</h2>`;
            let dropdownMenu = document.createElement("div");
            dropdownMenu.classList.add("dropdown-menu", "show");

            classes.forEach((classObj) => {
              let card = document.createElement("div");
              card.classList.add("class-card");
              card.dataset.class = classObj.pick;
              card.textContent = `${classObj.pick} (Added by ${classObj.user})`;
              card.addEventListener("click", function () {
                updateBackend(period, classObj.pick);
              });
              dropdownMenu.appendChild(card);
            });

            classListContainer.appendChild(dropdownMenu);
          });
        });
      });
  }

  function updateBackend(period, _class) {
    let channelId;
    fetch(pythonURI + "/api/channel/filter", {
      ...fetchOptions,
      method: "POST",
      body: JSON.stringify({
        group_name: "Classes",
        channel_name: "classlist",
      }),
    })
      .then((res) => res.json())
      .then((json) => {
        channelId = json.id;
        return fetch(pythonURI + "/api/post/user", fetchOptions);
      })
      .then((response) => response.json())
      .then((data) => {
        let periodList = data.filter((post) => post.channel_name === "classlist");
        let existingPost = periodList.find((post) => post.title == period);
        if (existingPost) {
          return fetch(`${pythonURI}/api/post`, {
            ...fetchOptions,
            method: "PUT",
            body: JSON.stringify({
              id: existingPost.id,
              title: period,
              content: { class: _class },
              channel_id: channelId,
            }),
          });
        } else {
          return fetch(pythonURI + "/api/post", {
            ...fetchOptions,
            method: "POST",
            body: JSON.stringify({
              title: period,
              comment: `Class choice for Period ${period}`,
              content: { class: _class },
              channel_id: channelId,
            }),
          });
        }
      })
      .catch((error) => console.error("Error:", error));
  }

  getClasses();
</script>
